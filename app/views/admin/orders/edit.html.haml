- content_for(:title) { concat "Order #{@order.id}" }
%h1= yield :title
=debug @order
- form_for :order, :url => admin_order_path(@order), :html => { :method => :put, :onsubmit => "form_submitted()" } do |f|
  .col-left
    %h2
      Shipping Address
    %table{ :cellspacing => "0"}
    %tr
      %td= label_tag "[shipping_address][first_name]", "First Name"
      %td= text_field_tag "[shipping_address][first_name]", @order.shipping_address.first_name, :size => 15
      %br 
    %tr
      %td= label_tag "[shipping_address][last_name]", "Last Name"
      %td= text_field_tag "[shipping_address][last_name]", @order.shipping_address.last_name, :size => 15 
      %br
    %tr
      %td= label_tag "[shipping_address][email]", "Email address" 
      %td= text_field_tag "[shipping_address][email]",@order.shipping_address.email, :size => 20 
      %br
    %tr
      %td= label_tag "[shipping_address][street_address]", "Street Address" 
      %td= text_field_tag "[shipping_address][street_address]",@order.shipping_address.street_address, :size => 20
      %br
    %tr
      %td= label_tag "[shipping_address][street_address_2]", "Street Address 2"  
      %td= text_field_tag "[shipping_address][street_address_2]",@order.shipping_address.street_address_2, :size => 20
      %br
    %tr
      %td= label_tag "[shipping_address][city]", "City" 
      %td= text_field_tag "[shipping_address][city]",@order.shipping_address.city, :size => 20 
      %br
    %tr
      %td= label_tag "[shipping_address][location_id]", "Locations"
      %td= select "[shipping_address][location_id]", "id", @locations.collect { |l| [l.name, l.id ]}, :selected => @order.shipping_address.location_id
      %br
    %tr
      %td= label_tag "[shipping_address][postal_code]", "Postal Code" 
      %td= text_field_tag "[shipping_address][postal_code]", @order.shipping_address.postal_code, :size => 12
      %br
    %div
      = select "shipping_method", "id", @shipping_methods.collect { |s| ["#{s.name} - #{number_to_currency s.price}", s.id] }, :selected => @order.shipping_method.id
  .col-right
    %h2
      Billing Address
    %table{ :cellspacing => "0"}
    %tr
      %td= label_tag "[billing_address][first_name]", "First Name"
      %td= text_field_tag "[billing_address][first_name]", @order.billing_address.first_name, :size => 15
      %br 
    %tr
      %td= label_tag "[billing_address][last_name]", "Last Name"
      %td= text_field_tag "[billing_address][last_name]", @order.billing_address.last_name, :size => 15 
      %br
    %tr
      %td= label_tag "[billing_address][email]", "Email address" 
      %td= text_field_tag "[billing_address][email]",@order.billing_address.email, :size => 20 
      %br
    %tr
      %td= label_tag "[billing_address][street_address]", "Street Address" 
      %td= text_field_tag "[billing_address][street_address]",@order.billing_address.street_address, :size => 20
      %br
    %tr
      %td= label_tag "[billing_address][street_address_2]", "Street Address 2"  
      %td= text_field_tag "[billing_address][street_address_2]",@order.billing_address.street_address_2, :size => 20
      %br
    %tr
      %td= label_tag "[billing_address][city]", "City" 
      %td= text_field_tag "[billing_address][city]",@order.billing_address.city, :size => 20 
      %br
    %tr
      %td= label_tag "[billing_address][location_id]", "Locations"
      %td= select "[billing_address][location_id]", "id", @locations.collect { |l| [l.name, l.id ]}, :selected => @order.billing_address.location_id
      %br
    %tr
      %td= label_tag "[billing_address][postal_code]", "Postal Code" 
      %td= text_field_tag "[billing_address][postal_code]", @order.billing_address.postal_code, :size => 12
      %br
  %br
  %table.full.cart{ :cellspacing => "0" }
    %thead
      %tr
        %th
          Item
        %th
          Price
        %th.center
          Quantity
        %th.right
          Total
    %tbody
      = render :partial => "/carts/cart_item", :collection => @order.order_items, :locals => { :for_order => true }
  %br
  %table.big{ :cellspacing => "0" }
    %tr
      %td
        Subtotal:
      %td
        = number_to_currency(@order.subtotal)
    %tr
      %td
        Sales Tax:
      %td
        = number_to_currency(@order.taxes_total)
    %tr
      %td
        Shipping:
      %td
        = number_to_currency(@order.shipping_total)
        = h @order.shipping_method.name
        
    %tr.bold
      %td
        Total:
      %td
        = number_to_currency(@order.total)
  %br
  %h2
    Transaction Details
  %table{ :cellspacing => "0" }
    %tr
      %td
        Card type:
      %td
        = h @order.card_type.titleize
    %tr
      %td
        Card number:
      %td
        = h @order.card_number
    %tr
      %td
        Gateway response:
      %td
        = h @order.response.message
    %tr
      %td
        Authorization:
      %td
        = h @order.response.authorization
  -fancy_submit admin_orders_path do
    = f.submit "Save Product"
